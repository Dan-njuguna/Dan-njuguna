name: üîÅ Update Daily Quote

on:
  schedule:
    - cron: "0 0 * * *"  # Daily at 00:00 UTC
  workflow_dispatch:

jobs:
  update-quote:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Fetch quote from API
        id: get-quote
        run: |
          curl -s https://zenquotes.io/api/today > quote.json
          echo "QUOTE=$(jq -r '.content + \" ‚Äî \" + .author' quote.json)" >> $GITHUB_ENV

      - name: Update README with new quote
        run: |
          sed -i "/<!-- QUOTE_START -->/,/<!-- QUOTE_END -->/c\<!-- QUOTE_START -->\n> ${QUOTE}\n<!-- QUOTE_END -->" README.md

      - name: Push changes
        run: |
          git config --global user.email "njugush020@gmail.com"
          git config --global user.name "Dan-njuguna"
          git remote set-url origin https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/${{ github.repository }}
          git add .
          git commit -m "üîÅ update daily tech quote" || echo "No changes to commit"
          git push
